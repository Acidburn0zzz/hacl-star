module Hacl.Impl.QTesla.Params

open FStar.Int
open Lib.IntTypes
open Lib.Buffer
open FStar.Int.Cast
open Hacl.Impl.QTesla.Constants

module S = QTesla.Params
module SHA3 = Hacl.SHA3
module I8 = FStar.Int8
module I16 = FStar.Int16
module I32 = FStar.Int32
module I64 = FStar.Int64
module UI16 = FStar.UInt16
module UI32 = FStar.UInt32
module UI64 = FStar.UInt64

#reset-options "--z3rlimit 100 --max_fuel 0 --max_ifuel 0 --admit_smt_queries true"

include Hacl.Impl.QTesla.Provable.Parameters

/// Parameters in QTesla.Params aren't marked as unfold or inline_for_extraction;
/// so we need to normalize them here
let params_n = size S.params_n
let params_k = size S.params_k
let params_q = to_elem S.params_q
let params_h = size S.params_h
let params_Le  = UI32.uint_to_t S.params_Le
let params_Ls = UI32.uint_to_t S.params_Ls
let params_B = to_elem S.params_B
let params_U = to_elem S.params_Ls
let params_d = size S.params_d
let params_genA = size S.params_bGenA

/// Parameters specific to the implementation and not in the spec
let params_barr_mult = I64.int_to_t 1
let params_barr_div = UI32.uint_to_t 29
let params_qinv = I64.int_to_t 3421990911
let params_q_log = size 29 // TODO: this can be computed
let params_r2_invn = I64.int_to_t 472064468
let params_b_bits = size 21
let params_rejection = to_elem S.params_Le

inline_for_extraction noextract
let params_SHAKE = SHA3.shake128_hacl
inline_for_extraction noextract
let params_cSHAKE = cshake128_qtesla

inline_for_extraction noextract
let shake_rate = shake128_rate

let crypto_hmbytes = size 64
let crypto_randombytes = size 32
let crypto_seedbytes = size 32
let crypto_c_bytes = size 32

/// Sizes calculated based on parameters, but that vary by parameter set
let crypto_secretkeybytes:size_t = (size I8.n /. size 8) *. params_n +. (size I8.n /. size 8) *. params_n *. params_k +. size 2 *. crypto_seedbytes
let crypto_publickeybytes = (params_q_log *. params_n *. params_k +. size 7) /. size 8 +. crypto_seedbytes
let crypto_bytes = ((params_n *. params_d +. size 7) /. (size 8)) +. crypto_c_bytes

/// Precomputed polynomials for doing NTT transformations

unfold let zeta_list : list elem_base = [
152487987L; 362708180L; 151084668L; 393585500L; 285507339L; 301982154L;
215753424L; 31155376L; 233716852L; 465705615L; 128512487L; 219324660L;
50229578L; 153034376L; 215476824L; 300536066L; 335024578L; 289187646L;
164713195L; 268061318L; 189759369L; 377168836L; 116435874L; 176113053L;
431517196L; 190900734L; 338220498L; 464878555L; 173361289L; 232250039L;
454096337L; 436656394L; 195787662L; 168565616L; 114027909L; 101482211L;
122304260L; 245339257L; 270992315L; 4286310L; 284182633L; 281862863L;
467931137L; 7603533L; 87296419L; 467325730L; 121905925L; 68965750L; 7622021L;
337743349L; 393551614L; 47124528L; 159423746L; 411556895L; 272161997L;
437233591L; 145848369L; 293644567L; 483816172L; 151632492L; 404105953L;
50166550L; 146739314L; 412145078L; 15864543L; 70750806L; 129965017L;
341088149L; 316683907L; 350635104L; 130053135L; 163148141L; 121505175L;
321911633L; 208679484L; 294431751L; 453314132L; 108343178L; 347335911L;
164705047L; 162721550L; 207020617L; 292545544L; 470584726L; 172724538L;
305647837L; 149867383L; 362637208L; 452440748L; 260522302L; 286994319L;
24740874L; 202044444L; 119470626L; 478104674L; 80911411L; 414592412L;
2221974L; 246379318L; 129955789L; 28799678L; 36003616L; 152368173L;
339611023L; 223510693L; 291221765L; 193132933L; 463217793L; 331552134L;
325636488L; 203402489L; 295759306L; 248357734L; 68229047L; 81897305L;
240159122L; 118053748L; 317468757L; 422053445L; 366729953L; 437649988L;
255661703L; 483132783L; 73941682L; 473070031L; 266941830L; 273715645L;
293305752L; 97728261L; 387416830L; 466510576L; 359483415L; 350097663L;
303812937L; 61983368L; 110765849L; 174098312L; 288799426L; 21108638L;
467492225L; 174686783L; 248408233L; 45473451L; 384747267L; 405224388L;
88952814L; 320950556L; 7845265L; 96262921L; 194785009L; 345346400L;
283984375L; 141922183L; 197095618L; 350922677L; 11272999L; 89297173L;
32109806L; 274225692L; 315879286L; 447761615L; 162801357L; 472516440L;
273754932L; 433704551L; 12277378L; 129604129L; 130765873L; 341928374L;
97220107L; 381055612L; 81197393L; 281134974L; 179347952L; 39761035L;
34072176L; 156107747L; 160521566L; 445615052L; 382999431L; 114761104L;
217307868L; 361522659L; 154828064L; 108616610L; 483961979L; 7594235L;
235284403L; 243224032L; 389934638L; 100293270L; 300649913L; 252603238L;
156952794L; 476122165L; 413580514L; 276718826L; 361292064L; 361798877L;
469444666L; 478187612L; 366087489L; 58364362L; 377641792L; 464279854L;
238407425L; 414624898L; 95101086L; 321027398L; 429694956L; 464583265L;
437187651L; 60881585L; 385486792L; 312091683L; 66834498L; 233738788L;
348037644L; 233604363L; 107253653L; 131016429L; 73947604L; 169670982L;
290195637L; 119921194L; 271135954L; 190934119L; 290478001L; 458387655L;
30555018L; 243654544L; 445824897L; 428159318L; 284210623L; 380070942L;
43667456L; 346591135L; 469657107L; 229110312L; 89859525L; 279253247L;
439931225L; 229136222L; 321034403L; 246424219L; 100693825L; 214223676L;
217294437L; 256157960L; 295265349L; 79251464L; 286824915L; 454734790L;
151846826L; 92265815L; 248302338L; 324806913L; 107169154L; 198491413L;
107136390L; 135693521L; 363861623L; 129717151L; 385117374L; 341459776L;
364530058L; 331840615L; 338653108L; 179941421L; 145194323L; 232142444L;
310117875L; 245100240L; 236651455L; 321450096L; 408132892L; 459643284L;
120999848L; 331994388L; 466033192L; 444350281L; 46244984L; 349366459L;
47312667L; 210852290L; 461907423L; 473508756L; 243941159L; 334095768L;
484392307L; 87495054L; 79707111L; 10325325L; 200821060L; 83579595L;
150963302L; 117650353L; 241599951L; 324099496L; 449053341L; 36312493L;
53120594L; 297622605L; 80558972L; 378548649L; 444726854L; 381040843L;
435710377L; 437798831L; 409728224L; 337424109L; 119488440L; 361132895L;
56096923L; 105509808L; 62508901L; 220866000L; 465933834L; 134955292L;
165152430L; 461194453L; 94958388L; 126965781L; 461323542L; 383847206L;
317476902L; 163556720L; 256017938L; 72928042L; 371345649L; 72741296L;
1132229L; 282268470L; 212115745L; 379618538L; 106905134L; 239955357L;
192105800L; 279633365L; 261297633L; 471571564L; 90968104L; 459175544L;
256276478L; 349475049L; 94611089L; 471946846L; 339973147L; 179509745L;
334215655L; 348294589L; 246487412L; 338690430L; 257410736L; 386561992L;
130193167L; 10375815L; 352823358L; 66528931L; 326800610L; 5109748L;
350056529L; 248785466L; 71808467L; 91140754L; 240803382L; 46545554L;
148468313L; 217897756L; 178220810L; 477609665L; 208790805L; 132277867L;
140742422L; 254913327L; 28667006L; 128372915L; 79301382L; 407186666L;
89552874L; 246186501L; 285455129L; 391678316L; 275180688L; 128264018L;
310322712L; 204235493L; 392483801L; 82342680L; 216812163L; 464479351L;
180360499L; 444647478L; 203271968L; 245690827L; 184373912L; 109600517L;
224566820L; 28243984L; 271488557L; 21295878L; 5023179L; 37276402L;
156173856L; 216282463L; 114627758L; 400597776L; 384792625L; 105917732L;
345779139L; 120948814L; 379908150L; 352765486L; 416168777L; 56042296L;
349589484L; 144728793L; 388255614L; 261690821L; 484844902L; 12918385L;
60552278L; 302475143L; 407425208L; 184843522L; 76793749L; 43262192L;
318572606L; 192724017L; 307990251L; 164548393L; 289980843L; 119689917L;
192248504L; 86870040L; 113677230L; 207612114L; 48663937L; 453434248L;
377339887L; 132917063L; 336896801L; 106411814L; 268777744L; 109251604L;
359574042L; 467613823L; 362251552L; 400195434L; 397227950L; 447715984L;
156476326L; 407995653L; 323955098L; 143648649L; 6572585L; 61447842L;
60823848L; 132376333L; 156552612L; 447237682L; 3352830L; 437079412L;
293474358L; 288464703L; 15328503L; 138579659L; 221291483L; 380584037L;
357161755L; 205687364L; 479414291L; 173269786L; 295661628L; 1098184L;
377981714L; 433970464L; 385767379L; 200391723L; 463310671L; 470707303L;
280545651L; 289143978L; 1390137L; 320221838L; 213802405L; 52847233L;
440579585L; 361337171L; 467447061L; 278099177L; 130391690L; 112618414L;
24013500L; 144924227L; 296806074L; 251842387L; 345992943L; 284162718L;
360902180L; 420467337L; 110656360L; 350012131L; 202820082L; 130403434L;
353559391L; 97646151L; 331494212L; 207981153L; 178821640L; 6093504L;
174655523L; 25199097L; 350851018L; 171708038L; 460816830L; 103136904L;
80524000L; 275742304L; 458552752L; 472541551L; 190172218L; 362093141L;
38733526L; 9645818L; 67304688L; 67935446L; 108377230L; 311977539L;
474309436L; 444125532L; 103441699L; 3468252L; 349723698L; 97903160L;
300076184L; 267658035L; 238838767L; 242177661L; 26606481L; 135193080L;
123327558L; 344360834L; 367595829L; 356606282L; 264791463L; 257139528L;
162368489L; 211890949L; 55564884L; 438861649L; 229441471L; 237272101L;
233185135L; 277657399L; 407149255L; 91300697L; 479685681L; 430422637L;
119519807L; 421727840L; 192635510L; 93585631L; 135381498L; 18652441L;
397908973L; 188581729L; 232327608L; 69565403L; 391762415L; 326530182L;
441347692L; 230134217L; 64984929L; 478944650L; 351581551L; 190325639L;
193670224L; 149376075L; 211003745L; 282313407L; 401282565L; 142157967L;
358980062L; 420121767L; 23490157L; 334750456L; 333888004L; 267502025L;
165819942L; 232587558L; 86202250L; 302042598L; 410443459L; 257125477L;
225677323L; 414705770L; 25685059L; 301886182L; 108044670L; 22721383L;
270234733L; 79875762L; 146613845L; 419895311L; 369960062L; 103044731L;
31676484L; 286660070L; 419993402L; 364984450L; 18133974L; 446533052L;
445715499L; 406972835L; 163019061L; 450202465L; 241240654L; 188881609L;
340298195L; 253414624L; 384263117L; 228275432L; 255596801L; 10999354L;
326104131L; 470162945L; 345212724L; 481147036L; 355238387L; 445490028L;
455415009L; 260881193L; 427862585L; 132654052L; 18007865L; 59818933L;
68142229L; 461931681L; 213097607L; 330845761L; 345671100L; 445951421L;
379951938L; 351197187L; 411141392L; 7263182L; 70699592L; 365421264L;
376472585L; 461484665L; 162243510L; 31855741L; 293625046L; 335452299L;
133496651L; 449999480L; 91675672L; 274948339L; 231546888L; 5898807L;
374453904L; 415664585L; 187816557L; 366875998L; 16795888L; 358324214L;
67223590L; 208260807L; 81751761L; 331910299L; 126163909L; 197637544L;
425142827L; 380092754L; 432163910L; 455820426L; 254980283L; 256358636L;
238549963L; 394492520L; 207988901L; 382035000L; 58514991L; 406817321L;
338951326L; 85955701L; 385883363L; 199611595L; 193846573L; 242046917L;
445871847L; 194675932L; 153430125L; 126399473L; 212399985L; 131399120L;
150281168L; 241101682L; 424624124L; 463829369L; 220399539L; 250758923L;
286498206L; 389690457L; 295269249L; 379701698L; 289778634L; 337591505L;
299401947L; 408084588L; 222627582L; 436090373L; 268654172L; 96674628L;
63939283L; 63956567L; 362372935L; 443759942L; 75655989L; 451148002L;
74813563L; 245300859L; 92113977L; 235932323L; 24871709L; 445930061L;
112311252L; 382591591L; 341672267L; 192081751L; 227249338L; 104393113L;
338268986L; 206994950L; 319724787L; 213198392L; 170478760L; 37605185L;
158287930L; 411833228L; 74675173L; 290411522L; 234950252L; 147659191L;
477676082L; 302215477L; 236037294L; 396241956L; 90037635L; 71703941L;
189694446L; 127714437L; 72581761L; 388695298L; 324058182L; 307942478L;
25250803L; 430776557L; 98441916L; 244856801L; 54851167L; 334050668L;
381066122L; 91898087L; 55879503L; 447270860L; 473167653L; 219844498L;
187193519L; 266952433L; 391729403L; 53226126L; 51780224L; 371399487L;
333787358L; 56263300L; 280390944L; 162069765L; 126088217L; 254997184L;
219544659L; 290699753L; 91930445L; 262038894L; 420981566L; 460776098L;
376255854L; 282871085L; 189434060L; 447641051L; 348987773L; 393608679L;
229566111L; 403901447L; 471446519L; 411894730L; 215726740L; 484920069L;
409829517L; 306172231L; 65880808L; 272668213L; 300554215L; 165356547L;
127919123L; 432943738L; 184462319L; 474779995L; 312870826L; 103228518L;
118983222L; 470656522L; 71417412L; 480528917L; 63072121L; 276207594L;
101611809L; 92202812L; 400978338L; 316767039L; 228776701L; 96935521L;
229917830L; 205039402L; 397476586L; 344074695L; 398615665L; 107334948L;
321477097L; 84224896L; 289704056L; 337221600L; 298175575L; 221915312L;
193369885L; 426129039L; 447853316L; 54842415L; 451086232L; 182463979L;
451831604L; 247440983L; 302608727L; 173057620L; 189163830L; 406954853L;
263838955L; 390119120L; 323062166L; 209857219L; 233847360L; 397630721L;
465926004L; 10245195L; 426687348L; 106435173L; 177694955L; 463447907L;
18002511L; 30155910L; 224512318L; 357311179L; 265219392L; 299513685L;
30291602L; 60997329L; 10326191L; 138035293L; 231111502L; 414088384L;
77026622L; 174972782L; 4116187L; 52092276L; 228872080L; 15308807L;
286405235L; 414584533L; 228392331L; 399460999L; 219125940L; 337293712L;
187192073L; 183965759L; 229399789L; 51179285L; 419512139L; 28392143L;
424986565L; 69672656L; 202415584L; 216120556L; 455470549L; 76078626L;
278191677L; 228751917L; 246802857L; 389799018L; 342470047L; 313959017L;
69383448L; 340686475L; 61470385L; 26192776L; 409901437L; 119717553L;
174793260L; 123425866L; 250300643L; 429290586L; 387248439L; 183926914L;
285901994L; 391555377L; 468207735L; 22116415L; 13034202L; 399447558L;
317569778L; 269660832L; 44359608L; 57347786L; 225367797L; 253610604L;
205790505L; 20120029L; 285335246L; 351522795L; 256987219L; 358102627L;
167191360L; 50532216L; 327731504L; 369248325L; 460123994L; 266415358L;
194297404L; 175124754L; 431803266L; 172719791L; 347394909L; 478670700L;
198769524L; 172061925L; 145181173L; 153659180L; 261113394L; 234615141L;
174150073L; 188625016L; 395363348L; 356478592L; 350375496L; 185431871L;
422914531L; 144616554L; 328948119L; 417580486L; 132620154L; 208514724L;
323125199L; 169409944L; 209437217L; 147304756L; 313577692L; 467533131L;
102365927L; 353952516L; 47854485L; 378899191L; 136952166L; 46435149L;
470355414L; 328058320L; 292689847L; 24707084L; 114822297L; 272180086L;
182640159L; 7628028L; 408073454L; 377046674L; 214221064L; 472655903L;
91461227L; 453378209L; 459785635L; 126296748L; 7369666L; 52466342L;
269961618L; 231883972L; 233439994L; 228009066L; 436059177L; 355741338L;
103186287L; 391072528L; 386169816L; 317017329L; 449528664L; 378844336L;
330396197L; 137599363L; 20911303L; 288139426L; 164788880L; 266741184L;
89618721L; 54677577L; 457226242L; 208474107L; 240521207L; 158524358L;
480614438L; 226941889L; 385643536L; 326188597L; 389903564L; 264886102L;
226747931L; 258540220L; 407142392L ]
 
unfold let zetainv_list : list elem_base = [
227437893L; 259230182L; 221092011L; 96074549L; 159789516L; 100334577L;
259036224L; 5363675L; 327453755L; 245456906L; 277504006L; 28751871L;
431300536L; 396359392L; 219236929L; 321189233L; 197838687L; 465066810L;
348378750L; 155581916L; 107133777L; 36449449L; 168960784L; 99808297L;
94905585L; 382791826L; 130236775L; 49918936L; 257969047L; 252538119L;
254094141L; 216016495L; 433511771L; 478608447L; 359681365L; 26192478L;
32599904L; 394516886L; 13322210L; 271757049L; 108931439L; 77904659L;
478350085L; 303337954L; 213798027L; 371155816L; 461271029L; 193288266L;
157919793L; 15622699L; 439542964L; 349025947L; 107078922L; 438123628L;
132025597L; 383612186L; 18444982L; 172400421L; 338673357L; 276540896L;
316568169L; 162852914L; 277463389L; 353357959L; 68397627L; 157029994L;
341361559L; 63063582L; 300546242L; 135602617L; 129499521L; 90614765L;
297353097L; 311828040L; 251362972L; 224864719L; 332318933L; 340796940L;
313916188L; 287208589L; 7307413L; 138583204L; 313258322L; 54174847L;
310853359L; 291680709L; 219562755L; 25854119L; 116729788L; 158246609L;
435445897L; 318786753L; 127875486L; 228990894L; 134455318L; 200642867L;
465858084L; 280187608L; 232367509L; 260610316L; 428630327L; 441618505L;
216317281L; 168408335L; 86530555L; 472943911L; 463861698L; 17770378L;
94422736L; 200076119L; 302051199L; 98729674L; 56687527L; 235677470L;
362552247L; 311184853L; 366260560L; 76076676L; 459785337L; 424507728L;
145291638L; 416594665L; 172019096L; 143508066L; 96179095L; 239175256L;
257226196L; 207786436L; 409899487L; 30507564L; 269857557L; 283562529L;
416305457L; 60991548L; 457585970L; 66465974L; 434798828L; 256578324L;
302012354L; 298786040L; 148684401L; 266852173L; 86517114L; 257585782L;
71393580L; 199572878L; 470669306L; 257106033L; 433885837L; 481861926L;
311005331L; 408951491L; 71889729L; 254866611L; 347942820L; 475651922L;
424980784L; 455686511L; 186464428L; 220758721L; 128666934L; 261465795L;
455822203L; 467975602L; 22530206L; 308283158L; 379542940L; 59290765L;
475732918L; 20052109L; 88347392L; 252130753L; 276120894L; 162915947L;
95858993L; 222139158L; 79023260L; 296814283L; 312920493L; 183369386L;
238537130L; 34146509L; 303514134L; 34891881L; 431135698L; 38124797L;
59849074L; 292608228L; 264062801L; 187802538L; 148756513L; 196274057L;
401753217L; 164501016L; 378643165L; 87362448L; 141903418L; 88501527L;
280938711L; 256060283L; 389042592L; 257201412L; 169211074L; 84999775L;
393775301L; 384366304L; 209770519L; 422905992L; 5449196L; 414560701L;
15321591L; 366994891L; 382749595L; 173107287L; 11198118L; 301515794L;
53034375L; 358058990L; 320621566L; 185423898L; 213309900L; 420097305L;
179805882L; 76148596L; 1058044L; 270251373L; 74083383L; 14531594L; 82076666L;
256412002L; 92369434L; 136990340L; 38337062L; 296544053L; 203107028L;
109722259L; 25202015L; 64996547L; 223939219L; 394047668L; 195278360L;
266433454L; 230980929L; 359889896L; 323908348L; 205587169L; 429714813L;
152190755L; 114578626L; 434197889L; 432751987L; 94248710L; 219025680L;
298784594L; 266133615L; 12810460L; 38707253L; 430098610L; 394080026L;
104911991L; 151927445L; 431126946L; 241121312L; 387536197L; 55201556L;
460727310L; 178035635L; 161919931L; 97282815L; 413396352L; 358263676L;
296283667L; 414274172L; 395940478L; 89736157L; 249940819L; 183762636L;
8302031L; 338318922L; 251027861L; 195566591L; 411302940L; 74144885L;
327690183L; 448372928L; 315499353L; 272779721L; 166253326L; 278983163L;
147709127L; 381585000L; 258728775L; 293896362L; 144305846L; 103386522L;
373666861L; 40048052L; 461106404L; 250045790L; 393864136L; 240677254L;
411164550L; 34830111L; 410322124L; 42218171L; 123605178L; 422021546L;
422038830L; 389303485L; 217323941L; 49887740L; 263350531L; 77893525L;
186576166L; 148386608L; 196199479L; 106276415L; 190708864L; 96287656L;
199479907L; 235219190L; 265578574L; 22148744L; 61353989L; 244876431L;
335696945L; 354578993L; 273578128L; 359578640L; 332547988L; 291302181L;
40106266L; 243931196L; 292131540L; 286366518L; 100094750L; 400022412L;
147026787L; 79160792L; 427463122L; 103943113L; 277989212L; 91485593L;
247428150L; 229619477L; 230997830L; 30157687L; 53814203L; 105885359L;
60835286L; 288340569L; 359814204L; 154067814L; 404226352L; 277717306L;
418754523L; 127653899L; 469182225L; 119102115L; 298161556L; 70313528L;
111524209L; 480079306L; 254431225L; 211029774L; 394302441L; 35978633L;
352481462L; 150525814L; 192353067L; 454122372L; 323734603L; 24493448L;
109505528L; 120556849L; 415278521L; 478714931L; 74836721L; 134780926L;
106026175L; 40026692L; 140307013L; 155132352L; 272880506L; 24046432L;
417835884L; 426159180L; 467970248L; 353324061L; 58115528L; 225096920L;
30563104L; 40488085L; 130739726L; 4831077L; 140765389L; 15815168L;
159873982L; 474978759L; 230381312L; 257702681L; 101714996L; 232563489L;
145679918L; 297096504L; 244737459L; 35775648L; 322959052L; 79005278L;
40262614L; 39445061L; 467844139L; 120993663L; 65984711L; 199318043L;
454301629L; 382933382L; 116018051L; 66082802L; 339364268L; 406102351L;
215743380L; 463256730L; 377933443L; 184091931L; 460293054L; 71272343L;
260300790L; 228852636L; 75534654L; 183935515L; 399775863L; 253390555L;
320158171L; 218476088L; 152090109L; 151227657L; 462487956L; 65856346L;
126998051L; 343820146L; 84695548L; 203664706L; 274974368L; 336602038L;
292307889L; 295652474L; 134396562L; 7033463L; 420993184L; 255843896L;
44630421L; 159447931L; 94215698L; 416412710L; 253650505L; 297396384L;
88069140L; 467325672L; 350596615L; 392392482L; 293342603L; 64250273L;
366458306L; 55555476L; 6292432L; 394677416L; 78828858L; 208320714L;
252792978L; 248706012L; 256536642L; 47116464L; 430413229L; 274087164L;
323609624L; 228838585L; 221186650L; 129371831L; 118382284L; 141617279L;
362650555L; 350785033L; 459371632L; 243800452L; 247139346L; 218320078L;
185901929L; 388074953L; 136254415L; 482509861L; 382536414L; 41852581L;
11668677L; 174000574L; 377600883L; 418042667L; 418673425L; 476332295L;
447244587L; 123884972L; 295805895L; 13436562L; 27425361L; 210235809L;
405454113L; 382841209L; 25161283L; 314270075L; 135127095L; 460779016L;
311322590L; 479884609L; 307156473L; 277996960L; 154483901L; 388331962L;
132418722L; 355574679L; 283158031L; 135965982L; 375321753L; 65510776L;
125075933L; 201815395L; 139985170L; 234135726L; 189172039L; 341053886L;
461964613L; 373359699L; 355586423L; 207878936L; 18531052L; 124640942L;
45398528L; 433130880L; 272175708L; 165756275L; 484587976L; 196834135L;
205432462L; 15270810L; 22667442L; 285586390L; 100210734L; 52007649L;
107996399L; 484879929L; 190316485L; 312708327L; 6563822L; 280290749L;
128816358L; 105394076L; 264686630L; 347398454L; 470649610L; 197513410L;
192503755L; 48898701L; 482625283L; 38740431L; 329425501L; 353601780L;
425154265L; 424530271L; 479405528L; 342329464L; 162023015L; 77982460L;
329501787L; 38262129L; 88750163L; 85782679L; 123726561L; 18364290L;
126404071L; 376726509L; 217200369L; 379566299L; 149081312L; 353061050L;
108638226L; 32543865L; 437314176L; 278365999L; 372300883L; 399108073L;
293729609L; 366288196L; 195997270L; 321429720L; 177987862L; 293254096L;
167405507L; 442715921L; 409184364L; 301134591L; 78552905L; 183502970L;
425425835L; 473059728L; 1133211L; 224287292L; 97722499L; 341249320L;
136388629L; 429935817L; 69809336L; 133212627L; 106069963L; 365029299L;
140198974L; 380060381L; 101185488L; 85380337L; 371350355L; 269695650L;
329804257L; 448701711L; 480954934L; 464682235L; 214489556L; 457734129L;
261411293L; 376377596L; 301604201L; 240287286L; 282706145L; 41330635L;
305617614L; 21498762L; 269165950L; 403635433L; 93494312L; 281742620L;
175655401L; 357714095L; 210797425L; 94299797L; 200522984L; 239791612L;
396425239L; 78791447L; 406676731L; 357605198L; 457311107L; 231064786L;
345235691L; 353700246L; 277187308L; 8368448L; 307757303L; 268080357L;
337509800L; 439432559L; 245174731L; 394837359L; 414169646L; 237192647L;
135921584L; 480868365L; 159177503L; 419449182L; 133154755L; 475602298L;
355784946L; 99416121L; 228567377L; 147287683L; 239490701L; 137683524L;
151762458L; 306468368L; 146004966L; 14031267L; 391367024L; 136503064L;
229701635L; 26802569L; 395010009L; 14406549L; 224680480L; 206344748L;
293872313L; 246022756L; 379072979L; 106359575L; 273862368L; 203709643L;
484845884L; 413236817L; 114632464L; 413050071L; 229960175L; 322421393L;
168501211L; 102130907L; 24654571L; 359012332L; 391019725L; 24783660L;
320825683L; 351022821L; 20044279L; 265112113L; 423469212L; 380468305L;
429881190L; 124845218L; 366489673L; 148554004L; 76249889L; 48179282L;
50267736L; 104937270L; 41251259L; 107429464L; 405419141L; 188355508L;
432857519L; 449665620L; 36924772L; 161878617L; 244378162L; 368327760L;
335014811L; 402398518L; 285157053L; 475652788L; 406271002L; 398483059L;
1585806L; 151882345L; 242036954L; 12469357L; 24070690L; 275125823L;
438665446L; 136611654L; 439733129L; 41627832L; 19944921L; 153983725L;
364978265L; 26334829L; 77845221L; 164528017L; 249326658L; 240877873L;
175860238L; 253835669L; 340783790L; 306036692L; 147325005L; 154137498L;
121448055L; 144518337L; 100860739L; 356260962L; 122116490L; 350284592L;
378841723L; 287486700L; 378808959L; 161171200L; 237675775L; 393712298L;
334131287L; 31243323L; 199153198L; 406726649L; 190712764L; 229820153L;
268683676L; 271754437L; 385284288L; 239553894L; 164943710L; 256841891L;
46046888L; 206724866L; 396118588L; 256867801L; 16321006L; 139386978L;
442310657L; 105907171L; 201767490L; 57818795L; 40153216L; 242323569L;
455423095L; 27590458L; 195500112L; 295043994L; 214842159L; 366056919L;
195782476L; 316307131L; 412030509L; 354961684L; 378724460L; 252373750L;
137940469L; 252239325L; 419143615L; 173886430L; 100491321L; 425096528L;
48790462L; 21394848L; 56283157L; 164950715L; 390877027L; 71353215L;
247570688L; 21698259L; 108336321L; 427613751L; 119890624L; 7790501L;
16533447L; 124179236L; 124686049L; 209259287L; 72397599L; 9855948L;
329025319L; 233374875L; 185328200L; 385684843L; 96043475L; 242754081L;
250693710L; 478383878L; 2016134L; 377361503L; 331150049L; 124455454L;
268670245L; 371217009L; 102978682L; 40363061L; 325456547L; 329870366L;
451905937L; 446217078L; 306630161L; 204843139L; 404780720L; 104922501L;
388758006L; 144049739L; 355212240L; 356373984L; 473700735L; 52273562L;
212223181L; 13461673L; 323176756L; 38216498L; 170098827L; 211752421L;
453868307L; 396680940L; 474705114L; 135055436L; 288882495L; 344055930L;
201993738L; 140631713L; 291193104L; 389715192L; 478132848L; 165027557L;
397025299L; 80753725L; 101230846L; 440504662L; 237569880L; 311291330L;
18485888L; 464869475L; 197178687L; 311879801L; 375212264L; 423994745L;
182165176L; 135880450L; 126494698L; 19467537L; 98561283L; 388249852L;
192672361L; 212262468L; 219036283L; 12908082L; 412036431L; 2845330L;
230316410L; 48328125L; 119248160L; 63924668L; 168509356L; 367924365L;
245818991L; 404080808L; 417749066L; 237620379L; 190218807L; 282575624L;
160341625L; 154425979L; 22760320L; 292845180L; 194756348L; 262467420L;
146367090L; 333609940L; 449974497L; 457178435L; 356022324L; 239598795L;
483756139L; 71385701L; 405066702L; 7873439L; 366507487L; 283933669L;
461237239L; 198983794L; 225455811L; 33537365L; 123340905L; 336110730L;
180330276L; 313253575L; 15393387L; 193432569L; 278957496L; 323256563L;
321273066L; 138642202L; 377634935L; 32663981L; 191546362L; 277298629L;
164066480L; 364472938L; 322829972L; 355924978L; 135343009L; 169294206L;
144889964L; 356013096L; 415227307L; 470113570L; 73833035L; 339238799L;
435811563L; 81872160L; 334345621L; 2161941L; 192333546L; 340129744L;
48744522L; 213816116L; 74421218L; 326554367L; 438853585L; 92426499L;
148234764L; 478356092L; 417012363L; 364072188L; 18652383L; 398681694L;
478374580L; 18046976L; 204115250L; 201795480L; 481691803L; 214985798L;
240638856L; 363673853L; 384495902L; 371950204L; 317412497L; 290190451L;
49321719L; 31881776L; 253728074L; 312616824L; 21099558L; 147757615L;
295077379L; 54460917L; 309865060L; 369542239L; 108809277L; 296218744L;
217916795L; 321264918L; 196790467L; 150953535L; 185442047L; 270501289L;
332943737L; 435748535L; 266653453L; 357465626L; 20272498L; 252261261L;
454822737L; 270224689L; 183995959L; 200470774L; 92392613L; 334893445L;
123269933L; 333490126L; 78835721L ]

/// Gaussian sampler parameters and precomputed CDTs

unfold let params_cdt32_rows = size 78
unfold let params_cdt32_cols = size 2

unfold let params_cdt32_v: list I32.t = [
    0x00000000l; 0x00000000l; // 0
    0x0601F22Al; 0x280663D4l; // 1
    0x11F09FFAl; 0x162FE23Dl; // 2
    0x1DA089E9l; 0x437226E8l; // 3
    0x28EAB25Dl; 0x04C51FE2l; // 4
    0x33AC2F26l; 0x14FDBA70l; // 5
    0x3DC767DCl; 0x4565C960l; // 6
    0x4724FC62l; 0x3342C78Al; // 7
    0x4FB448F4l; 0x5229D06Dl; // 8
    0x576B8599l; 0x7423407Fl; // 9
    0x5E4786DAl; 0x3210BAF7l; // 10
    0x644B2C92l; 0x431B3947l; // 11
    0x697E90CEl; 0x77C362C4l; // 12
    0x6DEE0B96l; 0x2798C9CEl; // 13
    0x71A92144l; 0x5765FCE4l; // 14
    0x74C16FD5l; 0x1E2A0990l; // 15
    0x7749AC92l; 0x0DF36EEBl; // 16
    0x7954BFA4l; 0x28079289l; // 17
    0x7AF5067Al; 0x2EDC2050l; // 18
    0x7C3BC17Cl; 0x123D5E7Bl; // 19
    0x7D38AD76l; 0x2A9381D9l; // 20
    0x7DF9C5DFl; 0x0E868CA7l; // 21
    0x7E8B2ABAl; 0x18E5C811l; // 22
    0x7EF7237Cl; 0x00908272l; // 23
    0x7F4637C5l; 0x6DBA5126l; // 24
    0x7F7F5707l; 0x4A52EDEBl; // 25
    0x7FA808CCl; 0x23290599l; // 26
    0x7FC4A083l; 0x69BDF2D5l; // 27
    0x7FD870CAl; 0x42275558l; // 28
    0x7FE5FB5Dl; 0x3EF82C1Bl; // 29
    0x7FEF1BFAl; 0x6C03A362l; // 30
    0x7FF52D4El; 0x316C2C8Cl; // 31
    0x7FF927BAl; 0x12AE54AFl; // 32
    0x7FFBBA43l; 0x749CC0E2l; // 33
    0x7FFD5E3Dl; 0x4524AD91l; // 34
    0x7FFE6664l; 0x535785B5l; // 35
    0x7FFF0A41l; 0x0B291681l; // 36
    0x7FFF6E81l; 0x132C3D6Fl; // 37
    0x7FFFAAFEl; 0x4DBC6BEDl; // 38
    0x7FFFCEFDl; 0x7A1E2D14l; // 39
    0x7FFFE41El; 0x4C6EC115l; // 40
    0x7FFFF059l; 0x319503C8l; // 41
    0x7FFFF754l; 0x5DDD0D40l; // 42
    0x7FFFFB43l; 0x0B9E9823l; // 43
    0x7FFFFD71l; 0x76B81AE1l; // 44
    0x7FFFFEA3l; 0x7E66A1ECl; // 45
    0x7FFFFF49l; 0x26F6E191l; // 46
    0x7FFFFFA1l; 0x2FA31694l; // 47
    0x7FFFFFCFl; 0x5247BEC9l; // 48
    0x7FFFFFE7l; 0x4F4127C7l; // 49
    0x7FFFFFF3l; 0x6FAA69FDl; // 50
    0x7FFFFFFAl; 0x0630D073l; // 51
    0x7FFFFFFDl; 0x0F2957BBl; // 52
    0x7FFFFFFEl; 0x4FD29432l; // 53
    0x7FFFFFFFl; 0x2CFAD60Dl; // 54
    0x7FFFFFFFl; 0x5967A930l; // 55
    0x7FFFFFFFl; 0x6E4C9DFFl; // 56
    0x7FFFFFFFl; 0x77FDCCC8l; // 57
    0x7FFFFFFFl; 0x7C6CE89El; // 58
    0x7FFFFFFFl; 0x7E6D116Fl; // 59
    0x7FFFFFFFl; 0x7F50FA31l; // 60
    0x7FFFFFFFl; 0x7FB50089l; // 61
    0x7FFFFFFFl; 0x7FE04C2Dl; // 62
    0x7FFFFFFFl; 0x7FF2C7C1l; // 63
    0x7FFFFFFFl; 0x7FFA8FE3l; // 64
    0x7FFFFFFFl; 0x7FFDCB1Bl; // 65
    0x7FFFFFFFl; 0x7FFF1DE2l; // 66
    0x7FFFFFFFl; 0x7FFFA6B7l; // 67
    0x7FFFFFFFl; 0x7FFFDD39l; // 68
    0x7FFFFFFFl; 0x7FFFF2A3l; // 69
    0x7FFFFFFFl; 0x7FFFFAEFl; // 70
    0x7FFFFFFFl; 0x7FFFFE1Bl; // 71
    0x7FFFFFFFl; 0x7FFFFF4Dl; // 72
    0x7FFFFFFFl; 0x7FFFFFBFl; // 73
    0x7FFFFFFFl; 0x7FFFFFE9l; // 74
    0x7FFFFFFFl; 0x7FFFFFF8l; // 75
    0x7FFFFFFFl; 0x7FFFFFFDl; // 76
    0x7FFFFFFFl; 0x7FFFFFFFl  // 77
]

unfold let params_cdt64_rows = size 79
unfold let params_cdt64_cols = size 1

unfold let params_cdt64_v: list I64.t = [
    0x0000000000000000L; // 0
    0x0601F22A500CC7A8L; // 1
    0x11F09FFA2C5FC47BL; // 2
    0x1DA089E986E44DD0L; // 3
    0x28EAB25D098A3FC4L; // 4
    0x33AC2F2629FB74E1L; // 5
    0x3DC767DC8ACB92C0L; // 6
    0x4724FC6266858F15L; // 7
    0x4FB448F4A453A0DAL; // 8
    0x576B8599E84680FEL; // 9
    0x5E4786DA642175EDL; // 10
    0x644B2C928636728DL; // 11
    0x697E90CEEF86C587L; // 12
    0x6DEE0B964F31939CL; // 13
    0x71A92144AECBF9C8L; // 14
    0x74C16FD53C541320L; // 15
    0x7749AC921BE6DDD7L; // 16
    0x7954BFA4500F2512L; // 17
    0x7AF5067A5DB840A0L; // 18
    0x7C3BC17C247ABCF5L; // 19
    0x7D38AD76552703B2L; // 20
    0x7DF9C5DF1D0D194EL; // 21
    0x7E8B2ABA31CB9022L; // 22
    0x7EF7237C012104E5L; // 23
    0x7F4637C5DB74A24BL; // 24
    0x7F7F570794A5DBD7L; // 25
    0x7FA808CC46520B31L; // 26
    0x7FC4A083D37BE5AAL; // 27
    0x7FD870CA844EAAAFL; // 28
    0x7FE5FB5D7DF05836L; // 29
    0x7FEF1BFAD80746C4L; // 30
    0x7FF52D4E62D85918L; // 31
    0x7FF927BA255CA95DL; // 32
    0x7FFBBA43E93981C4L; // 33
    0x7FFD5E3D8A495B23L; // 34
    0x7FFE6664A6AF0B69L; // 35
    0x7FFF0A4116522D02L; // 36
    0x7FFF6E8126587ADFL; // 37
    0x7FFFAAFE9B78D7DBL; // 38
    0x7FFFCEFDF43C5A28L; // 39
    0x7FFFE41E98DD822AL; // 40
    0x7FFFF059632A0790L; // 41
    0x7FFFF754BBBA1A80L; // 42
    0x7FFFFB43173D3045L; // 43
    0x7FFFFD71ED7035C3L; // 44
    0x7FFFFEA3FCCD43D9L; // 45
    0x7FFFFF494DEDC322L; // 46
    0x7FFFFFA15F462D28L; // 47
    0x7FFFFFCFA48F7D91L; // 48
    0x7FFFFFE79E824F8DL; // 49
    0x7FFFFFF3DF54D3FAL; // 50
    0x7FFFFFFA0C61A0E6L; // 51
    0x7FFFFFFD1E52AF77L; // 52
    0x7FFFFFFE9FA52863L; // 53
    0x7FFFFFFF59F5AC1BL; // 54
    0x7FFFFFFFB2CF525FL; // 55
    0x7FFFFFFFDC993BFEL; // 56
    0x7FFFFFFFEFFB9990L; // 57
    0x7FFFFFFFF8D9D13CL; // 58
    0x7FFFFFFFFCDA22DDL; // 59
    0x7FFFFFFFFEA1F462L; // 60
    0x7FFFFFFFFF6A0113L; // 61
    0x7FFFFFFFFFC09859L; // 62
    0x7FFFFFFFFFE58F81L; // 63
    0x7FFFFFFFFFF51FC6L; // 64
    0x7FFFFFFFFFFB9636L; // 65
    0x7FFFFFFFFFFE3BC3L; // 66
    0x7FFFFFFFFFFF4D6EL; // 67
    0x7FFFFFFFFFFFBA72L; // 68
    0x7FFFFFFFFFFFE546L; // 69
    0x7FFFFFFFFFFFF5DFL; // 70
    0x7FFFFFFFFFFFFC36L; // 71
    0x7FFFFFFFFFFFFE9AL; // 72
    0x7FFFFFFFFFFFFF7EL; // 73
    0x7FFFFFFFFFFFFFD1L; // 74
    0x7FFFFFFFFFFFFFEFL; // 75
    0x7FFFFFFFFFFFFFFAL; // 76
    0x7FFFFFFFFFFFFFFEL; // 77
    0x7FFFFFFFFFFFFFFFL  // 78
]
